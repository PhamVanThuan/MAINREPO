<div ng-controller="LossControlManager_InvoicePaymentsRootTileConfigurationCtrl"style="height: 670px;display:block;overflow: auto;">
<span class="mif-icon_name" spin-loader="loadingLossControlInvoices">
        <div class="row" style="padding-left:65%; text-align:right;">
            <div class="span5">
                <h3>Total to pay: <strong>R{{invoicesToPay.invoiceTotal}} ({{invoicesToPay.invoiceCount}})</strong></h3>
            </div>
            <div class="span2" style="align-content:center">
                <h4><button ng-click="submitInvoicePayment()" ng-show="invoicesToPay.$values.length && paymentCanBeMade">Submit for Payment</button></h4>
            </div>
        </div>
   
    <div id="groupedLossControlGrid" style="overflow-y:auto;">
    	<div id="lossControlSpinner" spin-loader="Starting"></div>
	    <div ng-repeat="group in groupedData">
	    	<label ng-click="collapseSpvGroup(group)" style="background-color: lightgrey" 
	    		ng-class="{collapsed_content_open:group.groupVisible, collapsed_content_collapsed: group.groupVisible==false}">
	    		<span class="row">
		    		<strong class="span8" style="font-size:14px;">{{group.Spv}}</strong>
                    <span class="span4" style="margin-right:10.4em">R {{group.invoiceSpvSum(group.attorneys)}} ({{group.invoiceSpvCount(group.attorneys)}})</span>
		    		<strong class="span4" style="margin-right:10em">R {{group.invoiceSpvPaidSum(group.attorneys)}} ({{group.invoiceSpvPaidCount(group.attorneys)}})</strong>
	    		</span>
	    	</label>
	    	<div ng-show="group.groupVisible" ng-repeat="attorney in group.attorneys">
	    		<label style="margin-left: 5em; background-color: #ecf0f1;position:relative;" 
	    			ng-click="collapseAttorneyGrid(attorney)"
	    			ng-class="{collapsed_content_open:attorney.gridVisible, collapsed_content_collapsed: (!!attorney.gridVisible)==false }">
	    			<span class="row">
		    			<strong class="span7">{{attorney.attorney}} </strong>
		    			<span class="span4" style="margin-left:2.5em">R {{sumInvoiceCollection(attorney.invoices)}} ({{attorney.invoices.length}})</span>
                        <strong class="span4" style="margin-left:12em">R {{attorney.invoicesPaidSum(attorney.invoices)}} ({{attorney.invoicesPaidCount(attorney.invoices)}})</strong>
	    				<loss-control-pay-attorney-button ng-show="!batchForTodayExists"></loss-control-pay-attorney-button>
	    			</span>
	    		</label>
	    		<div ng-show="attorney.gridVisible" style="margin-left: 10em; height: 250px" ui-grid="attorney.gridOptions"></div>
	    	</div>    		
	    </div>
    </div>
</span>
</div>