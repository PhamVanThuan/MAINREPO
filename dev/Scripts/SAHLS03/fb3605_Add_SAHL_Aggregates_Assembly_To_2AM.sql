USE [2AM]
GO

ALTER DATABASE [2AM] SET TRUSTWORTHY OFF
GO

ALTER DATABASE [2AM] SET TRUSTWORTHY ON
GO

sp_configure 'clr enabled', 1;
GO

RECONFIGURE WITH OVERRIDE;
GO

RECONFIGURE WITH OVERRIDE;
GO

If Not (Exists (Select * From sys.assemblies Where name = 'SAHLAggregates'))
Begin

	CREATE ASSEMBLY [SAHLAggregates]
    AUTHORIZATION [dbo]
    FROM 0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C010300AA2DCA540000000000000000E00002210B010B00002C00000006000000000000FE49000000200000006000000000001000200000000200000400000000000000040000000000000000A000000002000000000000030040850000100000100000000010000010000000000000100000000000000000000000B04900004B00000000600000C002000000000000000000000000000000000000008000000C000000784800001C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E74657874000000042A000000200000002C000000020000000000000000000000000000200000602E72737263000000C00200000060000000040000002E0000000000000000000000000000400000402E72656C6F6300000C0000000080000000020000003200000000000000000000000000004000004200000000000000000000000000000000E0490000000000004800000002000500002F0000781900000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000360002730800000A7D010000042A0000133002002C00000001000011000F01280900000A0A062D1F00027B010000040F01280A00000A6F0B00000A72010000706F0B00000A26002A5600027B010000040F017B010000046F0C00000A262A0000133004004F00000002000011007E0D00000A0A027B010000042C13027B010000046F0E00000A16FE0216FE012B0117000C082D1C00027B0100000416027B010000046F0E00000A19596F0F00000A0A0006731000000A0B2B00072A4E0002036F1100000A731200000A7D010000042A520003027B010000046F1300000A6F1400000A002A360002730800000A7D020000042A0000133002002900000001000011000F01280900000A0A062D1C00027B020000040F01280A00000A6F0B00000A1F2C6F1500000A26002A5600027B020000040F017B020000046F0C00000A262A00133004004F00000002000011007E0D00000A0A027B020000042C13027B020000046F0E00000A16FE0216FE012B0117000C082D1C00027B0200000416027B020000046F0E00000A17596F0F00000A0A0006731000000A0B2B00072A4E0002036F1100000A731200000A7D020000042A520003027B020000046F1300000A6F1400000A002A5200027E1600000A7D0300000402167D040000042A000000133003005100000001000011000F01281700000A16FE010A062D120002257B0400000417587D04000004002B2F0002257B0400000417587D04000004027B0400000417FE0116FE010A062D0F00020F01281800000A7D0300000400002A00000013300300460000000100001100027B0400000416FE0116FE010A062D1E00020F017B040000047D04000004020F017B030000047D03000004002B160002257B040000040F017B04000004587D04000004002A0000133002003A0000000300001100027B030000047E1600000A281900000A16FE010C082D12001200027B03000004281A00000A00002B0A001200FE150900000100060B2B00072A4E0002036F1B00000A281C00000A7D030000042A520003027C03000004281D00000A6F1E00000A002A62000223000000000000F8FF7D0500000402167D060000042A133003005100000001000011000F01281F00000A16FE010A062D120002257B0600000417587D06000004002B2F0002257B0600000417587D06000004027B0600000417FE0116FE010A062D0F00020F01282000000A7D0500000400002A00000013300300460000000100001100027B0600000416FE0116FE010A062D1E00020F017B060000047D06000004020F017B050000047D05000004002B160002257B060000040F017B06000004587D06000004002A000013300200380000000400001100027B0500000423000000000000F8FFFE010C082D12001200027B05000004282100000A00002B0A001200FE150A00000100060B2B00072A3A0002036F2200000A7D050000042A3E0003027B050000046F2300000A002A52000220000000807D0700000402167D080000042A133003005100000001000011000F01282400000A16FE010A062D120002257B0800000417587D08000004002B2F0002257B0800000417587D08000004027B0800000417FE0116FE010A062D0F00020F01282500000A7D0700000400002A00000013300300460000000100001100027B0800000416FE0116FE010A062D1E00020F017B080000047D08000004020F017B070000047D07000004002B160002257B080000040F017B08000004587D08000004002A000013300200340000000500001100027B070000042000000080FE010C082D12001200027B07000004282600000A00002B0A001200FE150B00000100060B2B00072A3A0002036F2700000A7D070000042A3E0003027B070000046F2800000A002A5200027E0D00000A7D0900000402167D0A0000042A133003005100000001000011000F01280900000A16FE010A062D120002257B0A00000417587D0A000004002B2F0002257B0A00000417587D0A000004027B0A00000417FE0116FE010A062D0F00020F01280A00000A7D0900000400002A00000013300300460000000100001100027B0A00000416FE0116FE010A062D1E00020F017B0A0000047D0A000004020F017B090000047D09000004002B160002257B0A0000040F017B0A000004587D0A000004002A0000133002004000000006000011007E0D00000A0A027B090000046F2900000A16FE0216FE010D092D1400027B090000040A120106281000000A00002B0A001201FE150500000100070C2B00082A3A0002036F1100000A7D090000042A3E0003027B090000046F1400000A002A360002730800000A7D0B0000042A000000133002002C00000001000011000F01280900000A0A062D1F00027B0B0000040F01280A00000A6F0B00000A72090000706F0B00000A26002A5600027B0B0000040F017B0B0000046F0C00000A262A0000133004004F00000002000011007E0D00000A0A027B0B0000042C13027B0B0000046F0E00000A16FE0216FE012B0117000C082D1C00027B0B00000416027B0B0000046F0E00000A19596F0F00000A0A0006731000000A0B2B00072A4E0002036F1100000A731200000A7D0B0000042A520003027B0B0000046F1300000A6F1400000A002A360002730800000A7D0C0000042A0000133002002C00000001000011000F01280900000A0A062D1F00027B0C0000040F01280A00000A6F0B00000A72110000706F0B00000A26002A5600027B0C0000040F017B0C0000046F0C00000A262A0000133004004F00000002000011007E0D00000A0A027B0C0000042C13027B0C0000046F0E00000A16FE0216FE012B0117000C082D1C00027B0C00000416027B0C0000046F0E00000A17596F0F00000A0A0006731000000A0B2B00072A4E0002036F1100000A731200000A7D0C0000042A520003027B0C0000046F1300000A6F1400000A002A360002730800000A7D0D0000042A0000133002002C00000001000011000F01280900000A0A062D1F00027B0D0000040F01280A00000A6F0B00000A72150000706F0B00000A26002A5600027B0D0000040F017B0D0000046F0C00000A262A0000133004004F00000002000011007E0D00000A0A027B0D0000042C13027B0D0000046F0E00000A16FE0216FE012B0117000C082D1C00027B0D00000416027B0D0000046F0E00000A17596F0F00000A0A0006731000000A0B2B00072A4E0002036F1100000A731200000A7D0D0000042A520003027B0D0000046F1300000A6F1400000A002A62000223000000000000F8FF7D0E00000402167D0F0000042A000000133003003C000000010000110002257B0F00000417587D0F0000040F01281F00000A0A062D2100027B0F00000418FE0116FE010A062D0F00020F01282000000A7D0E00000400002A133003008A00000001000011000F017B0F00000416FE010A062D7A00027B0F00000416FE0116FE010A062D1E00020F017B0F0000047D0F000004020F017B0E0000047D0E000004002B4A00027B0F00000418FE040A062D180002257B0F0000040F017B0F000004587D0F000004002B230002257B0F0000040F017B0F000004587D0F000004020F017B0E0000047D0E0000040000002A000013300200410000000400001100027B0E00000423000000000000F8FFFE010C082D12001200027B0E000004282100000A00002B13001200230000000000000000282100000A0000060B2B00072A3A0002036F2200000A7D0E0000042A3E0003027B0E0000046F2300000A002A5200027E0D00000A7D1000000402167D110000042A000000133003003C000000010000110002257B1100000417587D110000040F01280900000A0A062D2100027B1100000418FE0116FE010A062D0F00020F01280A00000A7D1000000400002A133003008A00000001000011000F017B1100000416FE010A062D7A00027B1100000416FE0116FE010A062D1E00020F017B110000047D11000004020F017B100000047D10000004002B4A00027B1100000418FE040A062D180002257B110000040F017B11000004587D11000004002B230002257B110000040F017B11000004587D11000004020F017B100000047D100000040000002A0000133002004000000006000011007E0D00000A0A027B100000046F2900000A16FE0216FE010D092D1400027B100000040A120106281000000A00002B0A001201FE150500000100070C2B00082A3A0002036F1100000A7D100000042A3E0003027B100000046F1400000A002A0013300500B30000000700001100282B00000A13081208282C00000A0A1201206C0700001717282D00000A00282E00000A0C12031202282F00000A1201282F00000A59283000000A001202283100000A13041203283200000A283300000A13051204283400000A23A96BED7DAAAA0A405B6A283500000A13061105283600000A001106283600000A00110511058E69185906068E691C5918283700000A00110611068E691A5906068E691A591A283700000A0006733800000A13072B0011072A001B300400A40100000800001100730800000A0A170B733900000A0C7219000070028C1E000001283A00000A0D72A8030070733B00000A13040011046F3C00000A00091104733D00000A13051105086F3E00000A260672D8030070086F3F00000A6F4000000A8C1E0000016F4100000A2606720A0400706F0B00000A2600086F3F00000A6F4200000A130838AF00000011086F4300000A742600000113060006722A0400706F0B00000A2606722E040070110672560400706F4400000A6F4100000A2606726C040070110672920400706F4400000A6F4100000A260672A6040070110672C80400706F4400000A6F4100000A260672D8040070110672060500706F4400000A6F4100000A260672240500706F0B00000A26086F3F00000A6F4000000A07FE0216FE01130911092D0C0672280500706F0B00000A260717580B0011086F4500000A130911093A41FFFFFFDE1D11087527000001130A110A14FE01130911092D08110A6F4600000A00DC0006722C0500706F0B00000A260672240500706F0B00000A2600DE14110414FE01130911092D0811046F4600000A00DC00066F1300000A284700000A13072B0011072A41340000020000007E000000C6000000440100001D00000000000000020000002C000000510100007D01000014000000000000001E02284800000A2A42534A4201000100000000000C00000076342E302E33303331390000000005006C000000CC090000237E0000380A0000FC05000023537472696E67730000000034100000300500002355530064150000100000002347554944000000741500000404000023426C6F620000000000000002000001571702000900000000FA25330016000001000000270000000D00000011000000450000002E0000000B000000480000001200000008000000010000000200000000000A000100000000000600DC00D5000A000D01F20006001E01D5000600310125010A006C01570106009B0191010600AD0191010600C001D5000A00DD0157010A00E90157010A00F30157010A000B0257010A004A02F200060081026E023B00950200000600C402A4020600E402A4020A001103F2000A003203F20006003903D50006006E034F03060084034F030600AB03D5000A002104F20006003604D50006006104D50006008104D5000600AD04D5000A00C004E6000600CA04D5000A00E604D0040A000705F4040A001905D0040A002805F4040A003B05E6000A005605E60006009B0588050A00C105E6000600DB05D5000000000001000000000001000100092110001D00000005000100010009211000280000000500020007000921100035000000050003000D00092110003F000000050005001300092110004A0000000500070019000921100053000000050009001F00092110005F00000005000B002500092110007300000005000C002B00092110008400000005000D003100092110009E00000005000E00370009211000AA000000050010003D0001001000B70000000D001200430001003F010A0001003F010A000100C90135000100D70139000100C9014D000100D70139000100C90139000100D70139000100C90172000100D701390001003F010A0001003F010A0001003F010A000100FC014D000100D70139000100FC0172000100D7013900502000000000860052010E00010060200000000086007601120001009820000000008600810118000200B02000000000860087011E0003000B2100000000E601A801230003001F2100000000E601BA0129000400342100000000860052010E0005004421000000008600760112000500792100000000860081012F000600902100000000860087011E000700EB2100000000E601A80123000700FF2100000000E601BA0129000800142200000000860052010E0009002C2200000000860076013C0009008C22000000008600810142000A00E022000000008600870148000B00262300000000E601A80123000B003A2300000000E601BA0129000C004F2300000000860052010E000D006823000000008600760150000D00C823000000008600810156000E001C2400000000860087015C000F00602400000000E601A80123000F006F2400000000E601BA01290010007F2400000000860052010E0011009424000000008600760161001100F424000000008600810167001200482500000000860087016D001300882500000000E601A80123001300972500000000E601BA0129001400A72500000000860052010E001500BC250000000086007601120015001C26000000008600810175001600702600000000860087011E001700BC2600000000E601A80123001700CB2600000000E601BA0129001800DB2600000000860052010E001900EC26000000008600760112001900242700000000860081017B001A003C2700000000860087011E001B00972700000000E601A80123001B00AB2700000000E601BA0129001C00C02700000000860052010E001D00D027000000008600760112001D000828000000008600810181001E00202800000000860087011E001F007B2800000000E601A80123001F008F2800000000E601BA0129002000A42800000000860052010E002100B428000000008600760112002100EC28000000008600810187002200042900000000860087011E0023005F2900000000E601A80123002300732900000000E601BA0129002400882900000000860052010E002500A429000000008600760150002500EC2900000000860081018D002600842A00000000860087015C002700D12A00000000E601A80123002700E02A00000000E601BA0129002800F02A00000000860052010E002900082B000000008600760112002900502B000000008600810193002A00E82B00000000860087011E002B00342C00000000E601A80123002B00432C00000000E601BA0129002C00542C000000009600130299002D00142D0000000096001C029E002D00F82E00000000861834020E002F00000001003A02000001004002000001004602000001004802000001003A02000001004002000001004602000001004802000001003A02000001004002000001004602000001004802000001003A02000001004002000001004602000001004802000001003A02000001004002000001004602000001004802000001003A02000001004002000001004602000001004802000001003A02000001004002000001004602000001004802000001003A02000001004002000001004602000001004802000001003A02000001004002000001004602000001004802000001003A02000001004002000001004602000001004802000001003A02000001004002000001004602000001004802000000000000000001005C0202000900030009000400090005000900060009000700090008000900090009000A0009000B0009000C000900690034020E0071003402CA0081003402D000890034020E0091003402D500A10034020E00A90034023D01210034020E0029008F03430129009A0347012100A4034B012100A4035501B900B20372002100B8035B012100C3035F012900340265013100CC0347012100340265011900C30347013900BA0165012100A40371014100D703350049008F03430149009A03D9014100E003DE0149003402E6013100EE03F4014100F803F80141000304F4013900BA01FE0151008F03430151009A03030251003402070231000C0403023900BA01070259008F03430159009A035B0159003402D000310017045B013900BA01D000B900B8035B01C10034020E00C9003B048C02C9004304910241003402960241004F049D0241005704F401D1003402FE0141006A04A202D10078045B01D9008E04A702D10097040302D9008E04AD02E100B304B302E100BB04B90261003402C402E90034020E00B90032038303F90034026501010114050E00090134028903110136059003E9004D059603210171055B0121007B059C032101A705A3032901B505A9033101C905AD032901D20543013901E7050E002900EF05B203190034020E002E002300E4032E001300D2032E001B00DB0343002B00DB0063002B00DB0083002B007701A3002B007701C3002B007701E3002B001C0203012B00DB0023012B00DB0043012B00DB0063012B001C0283012B001C02A4050B00A400C4050B00B70060085301870280085301DF0251016A01EC010C0214027E02CA02B803048000000000000000000000000000000000020300000400000000000000000000000100CC00000000000400000000000000000000000100E6000000000000000000003C4D6F64756C653E005341484C416767726567617465732E646C6C00416E6444656C696D697400436F6D6D6144656C696D697400466972737444617465004669727374466C6F6174004669727374496E74004669727374537472696E6700466F7277617264536C61736844656C696D6974004E6172726F77416E6444656C696D6974004E6172726F77466F7277617264536C61736844656C696D6974005365636F6E64466C6F6174005365636F6E64537472696E670055736572446566696E656446756E6374696F6E73006D73636F726C69620053797374656D0056616C7565547970650053797374656D2E44617461004D6963726F736F66742E53716C5365727665722E536572766572004942696E61727953657269616C697A65004F626A6563740053797374656D2E5465787400537472696E674275696C64657200696E7465726D656469617465526573756C7400496E69740053797374656D2E446174612E53716C54797065730053716C537472696E6700416363756D756C617465004D65726765005465726D696E6174650053797374656D2E494F0042696E61727952656164657200526561640042696E617279577269746572005772697465004461746554696D65006D5F4669727374526573756C74006D5F436E740053716C4461746554696D650053716C446F75626C650053716C496E743332006D5F5365636F6E64526573756C740053716C4775696400436F6D624775696400436170697465634170706C6963616E7473546F4A736F6E002E63746F720076616C7565006F74686572007200770053716C4661636574417474726962757465006170706C69636174696F6E4E756D6265720053797374656D2E446961676E6F73746963730044656275676761626C6541747472696275746500446562756767696E674D6F6465730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300436F6D70696C6174696F6E52656C61786174696F6E734174747269627574650052756E74696D65436F6D7061746962696C697479417474726962757465005341484C416767726567617465730053716C55736572446566696E656441676772656761746541747472696275746500466F726D61740053657269616C697A61626C654174747269627574650053797374656D2E52756E74696D652E496E7465726F705365727669636573005374727563744C61796F7574417474726962757465004C61796F75744B696E64006765745F49734E756C6C006765745F56616C756500417070656E6400537472696E6700456D707479006765745F4C656E67746800546F537472696E670052656164537472696E67004D696E56616C7565006F705F496E657175616C6974790052656164496E7436340046726F6D42696E61727900546F42696E6172790052656164446F75626C650052656164496E7433320053716C46756E6374696F6E4174747269627574650047756964004E65774775696400546F427974654172726179006765745F4E6F77006765745F5469636B730054696D655370616E006765745F54696D654F66446179006765745F4461797300426974436F6E766572746572004765744279746573006765745F546F74616C4D696C6C697365636F6E6473004172726179005265766572736500436F707900446174615461626C6500496E7433320053797374656D2E446174612E53716C436C69656E740053716C436F6E6E656374696F6E0053797374656D2E446174612E436F6D6D6F6E004462436F6E6E656374696F6E004F70656E0053716C446174614164617074657200446244617461416461707465720046696C6C0044617461526F77436F6C6C656374696F6E006765745F526F777300496E7465726E616C44617461436F6C6C656374696F6E42617365006765745F436F756E7400417070656E64466F726D61740053797374656D2E436F6C6C656374696F6E730049456E756D657261746F7200476574456E756D657261746F72006765745F43757272656E740044617461526F77006765745F4974656D004D6F76654E6578740049446973706F7361626C6500446973706F7365006F705F496D706C6963697400000007200026002000000720002F0020000003260000032F0000838D730065006C006500630074002000730061006C002E004E0061006D0065002000530061006C00750074006100740069006F006E002C00200070002E00460069007200730074004E0061006D0065002C00200070002E005300750072006E0061006D0065002C00200070002E004900640065006E0074006900740079004E0075006D006200650072002000660072006F006D0020005B0043006100700069007400650063005D002E005B00640062006F005D002E005B004100700070006C00690063006100740069006F006E005D00200061007000200028006E006F006C006F0063006B00290020006A006F0069006E0020005B0043006100700069007400650063005D002E005B00640062006F005D002E005B004100700070006C00690063006100740069006F006E004100700070006C006900630061006E0074005D002000610070006100200028006E006F006C006F0063006B00290020006F006E0020006100700061002E004100700070006C00690063006100740069006F006E004900640020003D002000610070002E004900640020006A006F0069006E0020005B0043006100700069007400650063005D002E005B00640062006F005D002E005B004100700070006C006900630061006E0074005D002000610070006C00200028006E006F006C006F0063006B00290020006F006E002000610070006C002E004900640020003D0020006100700061002E004100700070006C006900630061006E0074004900640020006A006F0069006E0020005B0043006100700069007400650063005D002E005B00640062006F005D002E005B0050006500720073006F006E005D0020007000200028006E006F006C006F0063006B00290020006F006E00200070002E004900640020003D002000610070006C002E0050006500720073006F006E004900440020006A006F0069006E0020005B0043006100700069007400650063005D002E005B00640062006F005D002E005B00530061006C00750074006100740069006F006E0045006E0075006D005D002000730061006C00200028006E006F006C006F0063006B00290020006F006E002000730061006C002E004900640020003D00200070002E00530061006C00750074006100740069006F006E0045006E0075006D00490064002000770068006500720065002000610070002E004100700070006C00690063006100740069006F006E004E0075006D0062006500720020003D0020007B0030007D00002F63006F006E007400650078007400200063006F006E006E0065006300740069006F006E003D00740072007500650000317B007B0022006E006F006F0066006100700070006C006900630061006E007400730022003A0022007B0030007D002200001F2C0022006100700070006C006900630061006E007400730022003A005B0000037B0000272200730061006C00750074006100740069006F006E0022003A0022007B0030007D0022002C000015530061006C00750074006100740069006F006E0000252200660069007200730074006E0061006D00650022003A0022007B0030007D0022002C000013460069007200730074006E0061006D006500002122007300750072006E0061006D00650022003A0022007B0030007D0022002C00000F5300750072006E0061006D006500002D22006900640065006E0074006900740079006E0075006D0062006500720022003A0022007B0030007D002200001D4900640065006E0074006900740079004E0075006D0062006500720000037D0000032C0000035D0000FBDDDC1942154A4F9016775F6E08C7B00008B77A5C561934E0890306121103200001052001011115052001011108042000111505200101121905200101121D05200101110C03061121020608052001011125052001011110042000112502060D052001011129052001011114042000112905200101112D052001011118042000112D02060E05200101111C05200101112005200101112405200101112805200101112C052001011130040000113105000111150812010001005408074D617853697A65FFFFFFFF120100010054020A49734E756C6C61626C650005200101113D042001010805200101114D6101000200000004005402124973496E76617269616E74546F4E756C6C73015402174973496E76617269616E74546F4475706C696361746573005402124973496E76617269616E74546F4F726465720054080B4D61784279746553697A65401F0000052001011159032000020320000E05200112110E0307010205200112111C032000080520020E0808042001010E0607030E1115020520011211036101000200000004005402124973496E76617269616E74546F4E756C6C73005402174973496E76617269616E74546F4475706C696361746573005402124973496E76617269616E74546F4F726465720054080B4D61784279746553697A65000200000420001121070002021121112105200101112107070311251125020320000A05000111210A042001010A0320000D042001010D0707031129112902070703112D112D026101000200000004005402124973496E76617269616E74546F4E756C6C73005402174973496E76617269616E74546F4475706C696361746573005402124973496E76617269616E74546F4F726465720054080B4D61784279746553697A65401F00000807040E1115111502040100000004000011650420001D0506200301080808040000112104200011690500011D05080500011D050A0500010112710A00050112710812710808052001011D051407091D0511211121116911691D051D051131116580A2010002005455794D6963726F736F66742E53716C5365727665722E5365727665722E446174614163636573734B696E642C2053797374656D2E446174612C2056657273696F6E3D342E302E302E302C2043756C747572653D6E65757472616C2C205075626C69634B6579546F6B656E3D623737613563353631393334653038390A446174614163636573730100000054020F497344657465726D696E6973746963010500020E0E1C062002010E127D05200108127505200012808D06200212110E1C0520001280950320001C0420011C0E05000111150E19070B12110812750E127D12808512809911151280950212809D0801000701000000000801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010000000000AA2DCA5400000000020000001C01000094480000942A000052534453E444971DC333B94CA737C3943BA54B5703000000643A5C6465762D625C44617461626173655C53514C5F434C525F46756E6374696F6E735C7372635C5341484C416767726567617465735C6F626A5C44656275675C5341484C416767726567617465732E706462000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000D84900000000000000000000EE490000002000000000000000000000000000000000000000000000E04900000000000000005F436F72446C6C4D61696E006D73636F7265652E646C6C0000000000FF25002000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100000001800008000000000000000000000000000000100010000003000008000000000000000000000000000000100000000004800000058600000640200000000000000000000640234000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000000000000000000000000000000003F000000000000000400000002000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B004C4010000010053007400720069006E006700460069006C00650049006E0066006F000000A001000001003000300030003000300034006200300000002C0002000100460069006C0065004400650073006300720069007000740069006F006E000000000020000000300008000100460069006C006500560065007200730069006F006E000000000030002E0030002E0030002E003000000048001300010049006E007400650072006E0061006C004E0061006D00650000005300410048004C0041006700670072006500670061007400650073002E0064006C006C00000000002800020001004C006500670061006C0043006F0070007900720069006700680074000000200000005000130001004F0072006900670069006E0061006C00460069006C0065006E0061006D00650000005300410048004C0041006700670072006500670061007400650073002E0064006C006C0000000000340008000100500072006F006400750063007400560065007200730069006F006E00000030002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000030002E0030002E0030002E0030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000C000000003A00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    WITH PERMISSION_SET = SAFE;

End
GO

If Not Exists (Select * From INFORMATION_SCHEMA.ROUTINES Where ROUTINE_SCHEMA = 'dbo' And ROUTINE_NAME = 'AndDelimit' And ROUTINE_TYPE='FUNCTION')
Begin 

	CREATE AGGREGATE [dbo].[AndDelimit](@value NVARCHAR (4000))
    RETURNS NVARCHAR (4000)
    EXTERNAL NAME [SAHLAggregates].[AndDelimit];
	
	Grant  EXECUTE ON [dbo].[AndDelimit] TO [public] AS [dbo];
	
End

If Not Exists (Select * From INFORMATION_SCHEMA.ROUTINES Where ROUTINE_SCHEMA = 'dbo' And ROUTINE_NAME = 'CommaDelimit' And ROUTINE_TYPE='FUNCTION')
Begin 

	CREATE AGGREGATE [dbo].[CommaDelimit](@value NVARCHAR (4000))
    RETURNS NVARCHAR (4000)
    EXTERNAL NAME [SAHLAggregates].[CommaDelimit];
	
	Grant  EXECUTE ON [dbo].[CommaDelimit] TO [public] AS [dbo];
	
End

If Not Exists (Select * From INFORMATION_SCHEMA.ROUTINES Where ROUTINE_SCHEMA = 'dbo' And ROUTINE_NAME = 'FirstDate' And ROUTINE_TYPE='FUNCTION')
Begin 	

	CREATE AGGREGATE [dbo].[FirstDate](@value DATETIME)
    RETURNS DATETIME
    EXTERNAL NAME [SAHLAggregates].[FirstDate];
	
	Grant  EXECUTE ON [dbo].[FirstDate] TO [public] AS [dbo];
	
End

If Not Exists (Select * From INFORMATION_SCHEMA.ROUTINES Where ROUTINE_SCHEMA = 'dbo' And ROUTINE_NAME = 'FirstFloat' And ROUTINE_TYPE='FUNCTION')
Begin 	

	CREATE AGGREGATE [dbo].[FirstFloat](@value FLOAT (53))
    RETURNS FLOAT (53)
    EXTERNAL NAME [SAHLAggregates].[FirstFloat];
	
	Grant  EXECUTE ON [dbo].[FirstFloat] TO [public] AS [dbo];
	
End

If Not Exists (Select * From INFORMATION_SCHEMA.ROUTINES Where ROUTINE_SCHEMA = 'dbo' And ROUTINE_NAME = 'FirstInt' And ROUTINE_TYPE='FUNCTION')
Begin 	
	
	CREATE AGGREGATE [dbo].[FirstInt](@value INT)
    RETURNS INT
    EXTERNAL NAME [SAHLAggregates].[FirstInt];
	
	Grant  EXECUTE ON [dbo].[FirstInt] TO [public] AS [dbo];
	
End

If Not Exists (Select * From INFORMATION_SCHEMA.ROUTINES Where ROUTINE_SCHEMA = 'dbo' And ROUTINE_NAME = 'FirstString' And ROUTINE_TYPE='FUNCTION')
Begin 		

	CREATE AGGREGATE [dbo].[FirstString](@value NVARCHAR (4000))
    RETURNS NVARCHAR (4000)
    EXTERNAL NAME [SAHLAggregates].[FirstString];
	
	Grant  EXECUTE ON [dbo].[FirstString] TO [public] AS [dbo];
	
End

If Not Exists (Select * From INFORMATION_SCHEMA.ROUTINES Where ROUTINE_SCHEMA = 'dbo' And ROUTINE_NAME = 'FirstString' And ROUTINE_TYPE='FUNCTION')
Begin 	
	
	CREATE AGGREGATE [dbo].[FirstString](@value NVARCHAR (4000))
    RETURNS NVARCHAR (4000)
    EXTERNAL NAME [SAHLAggregates].[FirstString];
	
	Grant  EXECUTE ON [dbo].[FirstString] TO [public] AS [dbo];
	
End

If Not Exists (Select * From INFORMATION_SCHEMA.ROUTINES Where ROUTINE_SCHEMA = 'dbo' And ROUTINE_NAME = 'ForwardSlashDelimit' And ROUTINE_TYPE='FUNCTION')
Begin 	
	
	CREATE AGGREGATE [dbo].[ForwardSlashDelimit](@value NVARCHAR (4000))
    RETURNS NVARCHAR (4000)
    EXTERNAL NAME [SAHLAggregates].[ForwardSlashDelimit];
	
	Grant  EXECUTE ON [dbo].[ForwardSlashDelimit] TO [public] AS [dbo];
	
End

If Not Exists (Select * From INFORMATION_SCHEMA.ROUTINES Where ROUTINE_SCHEMA = 'dbo' And ROUTINE_NAME = 'NarrowAndDelimit' And ROUTINE_TYPE='FUNCTION')
Begin 
		
	CREATE AGGREGATE [dbo].[NarrowAndDelimit](@value NVARCHAR (4000))
    RETURNS NVARCHAR (4000)
    EXTERNAL NAME [SAHLAggregates].[NarrowAndDelimit];
	
	Grant  EXECUTE ON [dbo].[NarrowAndDelimit] TO [public] AS [dbo];
	
End

If Not Exists (Select * From INFORMATION_SCHEMA.ROUTINES Where ROUTINE_SCHEMA = 'dbo' And ROUTINE_NAME = 'NarrowForwardSlashDelimit' And ROUTINE_TYPE='FUNCTION')
Begin 
		
	CREATE AGGREGATE [dbo].[NarrowForwardSlashDelimit](@value NVARCHAR (4000))
    RETURNS NVARCHAR (4000)
    EXTERNAL NAME [SAHLAggregates].[NarrowForwardSlashDelimit];
	
	Grant  EXECUTE ON [dbo].[NarrowForwardSlashDelimit] TO [public] AS [dbo];
	
End


If Not Exists (Select * From INFORMATION_SCHEMA.ROUTINES Where ROUTINE_SCHEMA = 'dbo' And ROUTINE_NAME = 'SecondFloat' And ROUTINE_TYPE='FUNCTION')
Begin 
		
	CREATE AGGREGATE [dbo].[SecondFloat](@value FLOAT (53))
    RETURNS FLOAT (53)
    EXTERNAL NAME [SAHLAggregates].[SecondFloat];
	
	Grant EXECUTE ON [dbo].[SecondFloat] TO [public] AS [dbo];
	
End

If Not Exists (Select * From INFORMATION_SCHEMA.ROUTINES Where ROUTINE_SCHEMA = 'dbo' And ROUTINE_NAME = 'SecondString' And ROUTINE_TYPE='FUNCTION')
Begin 
		
	CREATE AGGREGATE [dbo].[SecondString](@value NVARCHAR (4000))
    RETURNS NVARCHAR (4000)
    EXTERNAL NAME [SAHLAggregates].[SecondString];
	
	Grant  EXECUTE ON [dbo].[SecondString] TO [public] AS [dbo];
	
End
	

If Not Exists (Select * From INFORMATION_SCHEMA.ROUTINES Where ROUTINE_SCHEMA = 'dbo' And ROUTINE_NAME = 'CapitecApplicantsToJson' And ROUTINE_TYPE='FUNCTION')
Begin 		
	Execute sp_executesql N'CREATE FUNCTION [dbo].[CapitecApplicantsToJson](@applicationNumber INT)
	RETURNS NVARCHAR (MAX)
	WITH EXECUTE AS CALLER
	AS
	EXTERNAL NAME [SAHLAggregates].[UserDefinedFunctions].[CapitecApplicantsToJson]'
End

If Not Exists (Select * From INFORMATION_SCHEMA.ROUTINES Where ROUTINE_SCHEMA = 'dbo' And ROUTINE_NAME = 'CombGuid' And ROUTINE_TYPE='FUNCTION')
Begin 		
	Execute sp_executesql N'CREATE FUNCTION [dbo].[CombGuid]()
		RETURNS UNIQUEIDENTIFIER
		WITH EXECUTE AS CALLER
		AS
		EXTERNAL NAME [SAHLAggregates].[UserDefinedFunctions].[CombGuid]'
End


--Select [dbo].[CombGuid]()
