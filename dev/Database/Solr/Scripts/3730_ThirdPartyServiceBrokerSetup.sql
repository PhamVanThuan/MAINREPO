USE [2am]
GO
--	ALTER DATABASE [2am] SET trustworthy ON
--ALTER AUTHORIZATION ON DATABASE:: [2am] TO sa


/************** DROP ERROR OBJECTS ****************/

IF EXISTS (SELECT 1 
			FROM sys.services
			WHERE name = N'ThirdPartyErrorQueueInitiator')
BEGIN
	DROP SERVICE ThirdPartyErrorQueueInitiator
END
GO

IF EXISTS (SELECT 1 
			FROM sys.services
			WHERE name = N'ThirdPartyErrorQueueTarget')
BEGIN
	DROP SERVICE ThirdPartyErrorQueueTarget
END
GO

IF EXISTS (SELECT 1
			FROM sys.service_queues
			WHERE name = N'ThirdPartyErrorQueue')
BEGIN
	DROP QUEUE ThirdPartyErrorQueue
END
GO

IF EXISTS (SELECT 1
            FROM sys.objects
            WHERE object_id = OBJECT_ID(N'solr.pThirdPartyErrorQueueActivation')
            AND type IN ( N'P', N'PC' ))
BEGIN
	DROP PROCEDURE solr.pThirdPartyErrorQueueActivation
END
GO

/******************* DROP TARGET AND INITIATOR OBJECTS ************************/

IF EXISTS (SELECT 1 
			FROM sys.services
			WHERE name = N'ThirdPartyTargetService')
BEGIN
	DROP SERVICE ThirdPartyTargetService
END
GO

IF EXISTS (SELECT 1 
			FROM sys.services
			WHERE name = N'ThirdPartyInitiatorService')
BEGIN
	DROP SERVICE ThirdPartyInitiatorService
END
GO
 
IF EXISTS (SELECT 1 
			FROM sys.service_contracts
			WHERE name = N'ThirdPartyContract')
BEGIN
	DROP CONTRACT ThirdPartyContract
END
GO


IF EXISTS (SELECT 1 
			FROM sys.service_message_types
			WHERE name = N'ThirdPartyInitiatorMessage')
BEGIN
     DROP MESSAGE TYPE ThirdPartyInitiatorMessage
END
GO

IF EXISTS (SELECT 1 
			FROM sys.service_message_types
			WHERE name = N'ThirdPartyTargetMessage')
BEGIN
     DROP MESSAGE TYPE ThirdPartyTargetMessage
END
GO

IF EXISTS (SELECT 1
			FROM sys.service_queues
			WHERE name = N'ThirdPartyTargetQueue')
BEGIN
	DROP QUEUE ThirdPartyTargetQueue
END
GO

IF EXISTS (SELECT 1
			FROM sys.service_queues
			WHERE name = N'ThirdPartyInitiatorQueue')
BEGIN
	DROP QUEUE ThirdPartyInitiatorQueue
END
GO

IF EXISTS (SELECT 1
            FROM sys.objects
            WHERE object_id = OBJECT_ID(N'solr.SendSolrWebRequest')
            AND type IN ( N'P', N'PC' ))
BEGIN
	DROP PROCEDURE solr.SendSolrWebRequest
END
GO

IF EXISTS(	SELECT 1 
			FROM sys.assemblies 
			WHERE name = 'SolrUpdate.CLR')
BEGIN
	DROP ASSEMBLY [SolrUpdate.CLR]
END
GO



/*************************** CREATE THE MESSAGES *****************************/


CREATE MESSAGE TYPE ThirdPartyInitiatorMessage VALIDATION = WELL_FORMED_XML;
CREATE MESSAGE TYPE ThirdPartyTargetMessage  VALIDATION = WELL_FORMED_XML;

/*************************** CREATE THE CONTRACT *****************************/

CREATE CONTRACT ThirdPartyContract
(
  ThirdPartyInitiatorMessage SENT BY INITIATOR, 
  ThirdPartyTargetMessage  SENT BY TARGET
);

/******* Create the processing queue and service - specify the contract to allow sending to the service **********/
CREATE QUEUE ThirdPartyTargetQueue;
CREATE SERVICE ThirdPartyTargetService ON QUEUE ThirdPartyTargetQueue (ThirdPartyContract);



/******** Create the source queue and service **********************/
CREATE QUEUE ThirdPartyInitiatorQueue;
CREATE SERVICE ThirdPartyInitiatorService ON QUEUE ThirdPartyInitiatorQueue;

/**************** CREATE ASSEMBLY ******************/

CREATE ASSEMBLY [SolrUpdate.CLR]
    AUTHORIZATION [dbo]
    FROM 0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C010300E8250C550000000000000000E00002210B010B000034000000060000000000005E52000000200000006000000000001000200000000200000400000000000000060000000000000000A0000000020000000000000300608500001000001000000000100000100000000000001000000000000000000000000C5200004F00000000600000C002000000000000000000000000000000000000008000000C000000D45000001C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E7465787400000064320000002000000034000000020000000000000000000000000000200000602E72737263000000C0020000006000000004000000360000000000000000000000000000400000402E72656C6F6300000C0000000080000000020000003A0000000000000000000000000000400000420000000000000000000000000000000040520000000000004800000002000500742B00006025000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B3005006401000001000011007E0600000A0A00020328090000060B1202FE150100001B38D900000000007E0600000A0D07092805000006130408091104280400000613052B3F0011056F130000067201000070280700000A16FE01130811082D03002B2602720B00007028090000060B0709280500000613040809110428040000061305001713082BBC11056F0F00000620C8000000FE0116FE01130811082D0D1202280800000A280C0000060000DE4E130600000611067219000070280200000600060E040E050E06052803000006001202280800000A280C000006007E0600000A0A00DE14130700061107721900007028020000060000DE000000DE0000000405120217280B000006250A280900000A2D091202280A00000A2B011600130811083A00FFFFFF04280D0000060000DE3B13060000061106721900007028020000060000DE22130700280B00000A723F00007011076F0C00000A280D00000A6F0E00000A0000DE000000DE00002A4164000000000000A900000033000000DC0000001400000002000001000000001E00000088000000A60000004E00000002000001000000002A010000120000003C0100002200000002000001000000000700000020010000270100003B000000020000011B3005006A02000002000011007273000070730F00000A0A731000000A0B00066F1100000A0007066F1200000A0072A30000700C07086F1300000A00076F1400000A7272030070281500000A8C16000001731600000A6F1700000A26076F1400000A728A03007072A8030070731600000A6F1700000A26076F1400000A72B403007004731600000A6F1700000A26076F1400000A72CA030070036F1800000A731600000A6F1700000A26281900000A0D096F1A00000A130472DA03007011046F1B00000A72EA030070725A0400706F1C00000A04281D00000A1305076F1400000A725C0400701105731600000A6F1700000A26076F1400000A726A040070727C040070731600000A6F1700000A26076F1400000A728A04007072A2040070731600000A6F1700000A26076F1400000A72B404007011046F1E00000A6F1F00000A72EA030070725A0400706F1C00000A731600000A6F1700000A26076F2000000A130672CC0400700C07086F1300000A00076F1400000A6F2100000A00076F1400000A725B0600701106282200000A8C1E000001731600000A6F1700000A26076F1400000A7277060070036F0C00000A731600000A6F1700000A26076F1400000A729506007072AF060070731600000A6F1700000A26076F2300000A26076F1400000A6F2100000A00076F1400000A725B0600701106282200000A8C1E000001731600000A6F1700000A26076F1400000A727706007002731600000A6F1700000A26076F1400000A729506007072C3060070731600000A6F1700000A26076F2300000A26066F2400000A0000DE120714FE01130711072D07076F2500000A00DC00DE120614FE01130711072D07066F2500000A00DC002A00004134000002000000120000002F020000410200001200000000000000020000000C0000004A0200005602000012000000000000001B300400A5000000030000110072D30600701A8D010000010D091603A2091704A2091805A209190E04A209282600000A0A7273000070730F00000A0B0607732700000A0C00076F1100000A0008066F1300000A00086F1400000A6F2100000A00086F1400000A72640A007002731600000A6F1700000A26086F2300000A26076F2400000A0000DE120814FE01130411042D07086F2500000A00DC00DE120714FE01130411042D07076F2500000A00DC002A000000011C000002003800447C00120000000002003000619100120000000013300200240000000400001102727C0A0070282900000A6F2A00000A6F2B00000A720B000070280700000A0A2B00062A13300200240000000400001102727C0A0070282900000A6F2A00000A6F2B00000A72860A0070280700000A0A2B00062A1B300300370100000500001100046F2C00000A732D00000A0A00140B0006036F2E00000A00066F2F00000A00066F3000000A00046F3100000A0B076F3200000A0C08283300000A733400000A0D096F3500000A283600000A1304110472A40A0070282900000A6F3700000A7E010000042D1314FE0607000006733800000A80010000042B007E01000004280100002B280200002B169A6F3B00000A1305110472A40A0070282900000A6F3700000A7E020000042D1314FE0608000006733800000A80020000042B007E02000004280100002B280200002B169A6F3B00000A13067315000006130711070774310000016F3C00000A6F1000000600110711066F1200000600110711056F140000060011071309DE2B130800FE1A000714FE01130A110A2D07076F3D00000A0000DC0614FE01130A110A2D07066F2500000A00DC0011092A00414C00000000000010000000F80000000801000005000000020000010200000010000000FD0000000D0100001400000000000000020000000D00000014010000210100001200000000000000133002004D000000060000110002283E00000A74050000010A0672AC0A00706F3F00000A000672B60A00706F4000000A0006036F4100000A6A6F4200000A0006196F4300000A000672D80A00706F4400000A00060B2B00072A1E02284500000A2A0000001B300400DB00000007000011007E03000004284600000A16FE01130511052D65007273000070730F00000A0A00066F1100000A0072F60A007006732700000A0B076F2000000A740E000001800300000400DE120614FE01130511052D07066F2500000A00DC007E03000004280900000A16FE01130511052D0B72B10B0070734700000A7A00140C7E030000040D03720B000070280700000A16FE01130511052D13007E0300000402725A040070281D00000A0D000902720D0C007003284800000A281D00000A171202284900000A130511052D0B72270C0070734700000A7A0813042B0011042A00011000000200200027470012000000002E7E0600000A80030000042A1B300400A8000000080000110004FE150100001B7E0600000A0A7273000070730F00000A0B00076F1100000A00727B0C0070058C340000010203284A00000A07732700000A0C08166F4B00000A00086F4C00000A0D096F4D00000A16FE01130511052D2B000409166F4E00000A6F0C00000A734F00000A735000000A810100001B09176F4E00000A6F0C00000A0A00096F5100000A0000DE120714FE01130511052D07076F2500000A00DC000613042B0011042A0110000002001900748D0012000000001B3002004E00000009000011007273000070730F00000A0A00066F1100000A0072600F00700F00FE16040000016F0C00000A284800000A06732700000A0B076F2300000A2600DE100614FE010C082D07066F2500000A00DC002A00000110000002000C00303C0010000000001B3002004200000009000011007273000070730F00000A0A00066F1100000A0072900F007002284800000A06732700000A0B076F2300000A2600DE100614FE010C082D07066F2500000A00DC002A00000110000002000C0024300010000000001B300400650000000A0000110000160A735200000A0B0772C60F00700272D40F0070285300000A6F5400000A0007036F5500000A0C086F5600000A16FE0216FE01130411042D1D0008086F5600000A17596F5700000A6F5800000A1200285900000A2600060DDE062600160DDE0000092A00000001100000000001005B5C000601000001133001000B0000000B000011027B040000040A2B00062A2202037D040000042A133001000B0000000C000011027B050000040A2B00062A2202037D050000042A133001000B0000000C000011027B060000040A2B00062A2202037D060000042A1E02284500000A2A42534A4201000100000000000C00000076342E302E33303331390000000005006C000000A0070000237E00000C080000980A000023537472696E677300000000A4120000E40F0000235553008822000010000000234755494400000098220000C802000023426C6F620000000000000002000001571DA209090A000000FA2533001600000100000039000000050000000600000015000000230000005900000001000000110000000C000000010000000300000006000000020000000100000006000000030000000200000000000A0001000000000006006E0067000600880067000600AC0067000600B70067000A00C700BC000A00EC0067000A007F01BC000600840365030600B903A6032700CD0300000600FC03DC0306001C04DC030E00700455040600860467000E00C40455040E00CF0455040E000B05F5040E001905F5040E00370524050E00580524050E007205F5040600980567000E00A905F5040600D805C6050600F405C6050600FF05670006003F06C6050E007006240506008C06670006009C0667000600B80667001200DC06CC0606000307670006003107DC0312008F07CC061200A107CC060A00B607BC000600CB07C1070600E307C1070600F007C1070A000708BC0006003D08310806004F08C10706005C08C10712007108CC0612008108CC060600A7088C081600D908CD080A00F208BC0006006A0950090A00BA0967000600D30967000E00EC09F5040E00080A24051A002E0A230A1A00420A230A1A006D0A230A0000000001000000000001000100010010001D000000050001000100820110002E0000000500030009008201100038000000050004000B000200100055000000050004000F0011000A074B01110068074B0111000B0140000100FC017D0001001C02400001003C024000502000000000960075000A0001002422000000009100920015000800D0240000000091009B001D000B000026000000009100D600260010009027000000009100F00034001300E92700000000861805013C001500A025000000009100E50644011500D0250000000091004C0744011600F427000000009600160143001700EC28000000009118CC0934021900F82800000000960028014A001900BC290000000096003C0158001D00282A0000000096004C015E001E00882A000000009600610163001F000C2B0000000086088E0169002100232B000000008608A1016E0021002C2B000000008608B40174002200432B000000008608C701780022004C2B000000008608DA0174002300632B000000008608EB01780023006C2B00000000861805013C002400000001007602000002008002000003008B02000004009B0200000500A30200000600B40200000700C50200000100CE0200000200DA0200000300DD0200000100CE0200000200E80200000300F40200000400FE02000005000703000001001303000002002603000003003603000001003E03000002002603000001000107000001000107000001007602000002008002000001004203000002004C0302000300130310100400910300000100130300000100420300000100CE0200000200950300000100A00300000100A00300000100A003410005013C00490005018F00590005019500610005013C00690005013C0071008D04400071009304A1000C009F04A7007100A904AC000C00B704B1007900D704B5000900E00474007100E904BA008100F0047800890005017800910005013C00990044053C0091004905D600A1006205780091008905DC00B100A105E100B9000501E600A900B605EC001100BA057400C100E305F300C9000406F800D1001606740071003006FD00710038060301D10048060A01D90055067400A10062060F01E10086063C00E90094061301A100A20618019900B2063C00F900C4063C00710038062B01910005013201110105013C001901950756010101AC075D0121019F0474002901D2076A013901050170014101FB077800410101083C004101B2063C0029011308770149011F086A01510146087D0159010501830161016708740069017B088D017101B508940114000501AC018101E408B2018101EA08D20101019F0474008901020969004901B2063C0029011109FB0129011809780029012309780071003309180129013E090302290182090802290099097800090005013C007100A709AC001100050178007100380616023100C2091C02710038063802A100D90995009100FA094002B101150AB100B1011A0A46022100050178000C0005014B02B101B2063C00B90105013C007100E9046602B9013A0A7800B9014E0A6D02C101630A1801C101750A7402C901800A7400A1018D0A7B02080071008A0020002B008A00210043018A002E00130097022E002300A9022E001B00A002410043018A00810043018A00A10043018A00C10043018A00E00043018A00000143018A00E00143018A00000243018A00200243018A00400243018A00600243018A00800243018A00C0001C0139016601E0010F02270251025E0282028E0293020500010000007F01810000005A02860000006902860002000F0003000100100003000200110005000100120005000200130007000100140007009A00A2010480000000000000000000000000000000003A04000004000000000000000000000001005E0000000000040000000000000000000000010067000000000004000000000000000000000001004904000000000400000000000000000000000100CC06000000000400000000000000000000000100C108000000000400000000000000000000000100230A000000000300020004000200050002007300CC017500CC0100000000003C4D6F64756C653E00536F6C725570646174652E434C522E646C6C0053746F72656450726F636564757265730055726948656C706572005365727669636542726F6B65724D6573736167696E6748656C70657200526573706F6E7365006D73636F726C69620053797374656D004F626A6563740053656E64536F6C725765625265717565737400457863657074696F6E004C6F674572726F720053656E64546F4572726F725175657565004E756C6C61626C65603100477569640053797374656D2E4E657400487474705765625265717565737400476574526573706F6E7365487474705374617475730055726900437265617465536F6C7257656252657175657374002E63746F7200536F6C7257656255524900476574536F6C7244617461576562555249004765744D65737361676546726F6D517565756500456E64436F6E766572736174696F6E005265736574517565756541637469766174696F6E004765744B657942795461674E616D6546726F6D586D6C4D6573736167650048747470537461747573436F6465006765745F48747470537461747573436F6465007365745F48747470537461747573436F6465006765745F496D706F7274526573706F6E7365007365745F496D706F7274526573706F6E7365006765745F496D706F7274537461747573007365745F496D706F7274537461747573003C48747470537461747573436F64653E6B5F5F4261636B696E674669656C64003C496D706F7274526573706F6E73653E6B5F5F4261636B696E674669656C64003C496D706F72745374617475733E6B5F5F4261636B696E674669656C6400496D706F7274526573706F6E736500496D706F727453746174757300696E6465784E616D6500696D706F7274547970650054617267657451756575654E616D65004D65737361676500496E69746961746F7253657276696365004572726F72517565756554617267657400436F6E7472616374004D657373616765426F6479006578006D6574686F644E616D650066726F6D5365727669636500746F5365727669636500636F6E7472616374006D6573736167655479706500636F6E766572736174696F6E48616E646C650072657175657374436F6E74656E74730072657175657374007572690071756575654E616D65006D657373616765547970654E616D65546F50726F636573730053797374656D2E52756E74696D652E496E7465726F705365727669636573004F757441747472696275746500746F70004B65795461674E616D650076616C75650053797374656D2E446961676E6F73746963730044656275676761626C6541747472696275746500446562756767696E674D6F6465730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300436F6D70696C6174696F6E52656C61786174696F6E734174747269627574650052756E74696D65436F6D7061746962696C69747941747472696275746500536F6C725570646174652E434C520053797374656D2E44617461004D6963726F736F66742E53716C5365727665722E5365727665720053716C50726F63656475726541747472696275746500537472696E6700456D707479006F705F457175616C697479006765745F56616C75650049734E756C6C4F72456D707479006765745F48617356616C75650053716C436F6E746578740053716C50697065006765745F5069706500546F537472696E6700436F6E6361740053656E640053797374656D2E446174612E53716C436C69656E740053716C436F6E6E656374696F6E0053716C436F6D6D616E640053797374656D2E446174612E436F6D6D6F6E004462436F6E6E656374696F6E004F70656E007365745F436F6E6E656374696F6E004462436F6D6D616E64007365745F436F6D6D616E64546578740053716C506172616D65746572436F6C6C656374696F6E006765745F506172616D6574657273004461746554696D65006765745F4E6F770053716C506172616D6574657200416464006765745F4D6573736167650053797374656D2E5265666C656374696F6E004D6574686F64426173650047657443757272656E744D6574686F64004D656D626572496E666F0054797065006765745F4465636C6172696E6754797065006765745F417373656D626C795175616C69666965644E616D65005265706C61636500466F726D617400417373656D626C79006765745F417373656D626C79006765745F46756C6C4E616D6500457865637574655363616C6172004462506172616D65746572436F6C6C656374696F6E00436C65617200436F6E7665727400546F496E74363400496E74363400457865637574654E6F6E517565727900436C6F73650049446973706F7361626C6500446973706F73650053797374656D2E586D6C2E4C696E710058456C656D656E74003C476574526573706F6E7365487474705374617475733E625F5F3100780046756E636032004353243C3E395F5F436163686564416E6F6E796D6F75734D6574686F6444656C65676174653300436F6D70696C657247656E657261746564417474726962757465003C476574526573706F6E7365487474705374617475733E625F5F32004353243C3E395F5F436163686564416E6F6E796D6F75734D6574686F6444656C65676174653400584E616D65006F705F496D706C6963697400584174747269627574650041747472696275746500576562526571756573740053797374656D2E494F0053747265616D004765745265717565737453747265616D0053747265616D577269746572005465787457726974657200577269746500466C75736800576562526573706F6E736500476574526573706F6E736500476574526573706F6E736553747265616D0053797374656D2E5465787400456E636F64696E67006765745F555446380053747265616D52656164657200546578745265616465720052656164546F456E640058446F63756D656E740050617273650058436F6E7461696E65720053797374656D2E436F6C6C656374696F6E732E47656E657269630049456E756D657261626C6560310044657363656E64616E74730053797374656D2E436F72650053797374656D2E4C696E7100456E756D657261626C6500576865726500546F41727261790048747470576562526573706F6E7365006765745F537461747573436F646500437265617465007365745F4D6574686F64007365745F436F6E74656E7454797065006765745F4C656E677468007365745F436F6E74656E744C656E6774680053797374656D2E53656375726974792E5072696E636970616C00546F6B656E496D706572736F6E6174696F6E4C6576656C007365745F496D706572736F6E6174696F6E4C6576656C007365745F557365724167656E740049734E756C6C4F7257686974655370616365005572694B696E6400547279437265617465002E6363746F7200496E743332007365745F436F6D6D616E6454696D656F75740053716C446174615265616465720045786563757465526561646572004462446174615265616465720052656164006765745F4974656D0053797374656D2E586D6C00586D6C446F63756D656E74004C6F6164586D6C00586D6C4E6F64654C69737400476574456C656D656E747342795461674E616D65006765745F436F756E7400586D6C4E6F6465006765745F4974656D4F66006765745F496E6E6572586D6C0054727950617273650000000009690064006C006500000D7300740061007400750073000025530065006E00640053006F006C007200570065006200520065007100750065007300740000334600610069006C006500640020006C006F006700670069006E006700200045007800630065007000740069006F006E003A00002F63006F006E007400650078007400200063006F006E006E0065006300740069006F006E003D0074007200750065000082CD49004E005300450052005400200049004E0054004F0020005B0043007500740074006C00650066006900730068005D002E005B00640062006F005D002E005B004C006F0067004D006500730073006100670065005D002000280020005B004D0065007300730061006700650044006100740065005D002C0020005B004C006F0067004D0065007300730061006700650054007900700065005D002C0020005B004D006500740068006F0064004E0061006D0065005D002C0020005B004D006500730073006100670065005D002C0020005B0053006F0075007200630065005D002C0020005B0055007300650072004E0061006D0065005D002C0020005B004D0061006300680069006E0065004E0061006D0065005D002C0020005B004100700070006C00690063006100740069006F006E005D00200029000D000A0020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000560041004C005500450053002000280040006D0065007300730061006700650044006100740065002C00200040006C006F0067004D0065007300730061006700650054007900700065002C00200040006D006500740068006F0064004E0061006D0065002C00200040006D006500730073006100670065002C002000400073006F0075007200630065002C002000400075007300650072004E0061006D0065002C00200040006D0061006300680069006E0065004E0061006D0065002C00200040006100700070006C00690063006100740069006F006E0029003B000D000A0020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000530045004C004500430054002000530043004F00500045005F004900440045004E005400490054005900280029003B0000176D006500730073006100670065004400610074006500001D6C006F0067004D006500730073006100670065005400790070006500000B4500720072006F00720000156D006500740068006F0064004E0061006D006500000F6D00650073007300610067006500000F7B0030007D002E007B0031007D00006F2C002000560065007200730069006F006E003D0030002E0030002E0030002E0030002C002000430075006C0074007500720065003D006E00650075007400720061006C002C0020005000750062006C00690063004B006500790054006F006B0065006E003D006E0075006C006C000001000D73006F007500720063006500001175007300650072004E0061006D006500000D530079007300740065006D0000176D0061006300680069006E0065004E0061006D00650000114400610074006100620061007300650000176100700070006C00690063006100740069006F006E0000818D49004E005300450052005400200049004E0054004F0020005B0043007500740074006C00650066006900730068005D002E005B00640062006F005D002E005B004D0065007300730061006700650050006100720061006D00650074006500720073005D002000280020005B004C006F0067004D006500730073006100670065005F00690064005D002C0020005B0050006100720061006D006500740065007200560061006C00750065005D002C0020005B0050006100720061006D0065007400650072004B00650079005D00200029000D000A0020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000560041004C00550045005300280040006C006F0067004D006500730073006100670065005F00690064002C002000400070006100720061006D006500740065007200560061006C00750065002C002000400070006100720061006D0065007400650072004B00650079002900001B6C006F0067004D006500730073006100670065005F0069006400001D70006100720061006D006500740065007200560061006C0075006500001970006100720061006D0065007400650072004B0065007900001345007800630065007000740069006F006E00000F4D0065007300730061006700650000838F4400450043004C00410052004500200040004400690061006C006F0067005F00480061006E0064006C006500200055004E0049005100550045004900440045004E005400490046004900450052000D000A002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200042004500470049004E0020004400490041004C004F004700200043004F004E0056004500520053004100540049004F004E00200040004400690061006C006F0067005F00480061006E0064006C0065000D000A0020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000460052004F004D002000530045005200560049004300450020007B0030007D000D000A002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200054004F0020005300450052005600490043004500200027007B0031007D0027000D000A00200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020004F004E00200043004F004E005400520041004300540020007B0032007D000D000A00200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020005700490054004800200045004E004300520059005000540049004F004E0020003D0020004F00460046003B000D000A000D000A0020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000530045004E00440020004F004E00200043004F004E0056004500520053004100540049004F004E00200040004400690061006C006F0067005F00480061006E0064006C0065000D000A00200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020004D004500530053004100470045002000540059005000450020007B0033007D002000280040004D0065007300730061006700650042006F006400790029003B0001174D0065007300730061006700650042006F006400790000096E0061006D006500001D69006D0070006F007200740052006500730070006F006E00730065000007730074007200000950004F005300540000216100700070006C00690063006100740069006F006E002F006A0073006F006E00001D530051004C002000530065007200760065007200200043004C0052000080B9530065006C00650063007400200043006F006E00740072006F006C0054006500780074002000660072006F006D0020005B00320041004D005D002E005B00640062006F005D002E0043006F006E00740072006F006C00200028006E006F006C006F0063006B002900200077006800650072006500200043006F006E00740072006F006C004400650073006300720069007000740069006F006E0020003D002000270053006F006C0072005700650062005500520049002700015B430061006E006E006F0074002000660069006E006400200053006F006C00720020005700650062002000550052004900200069006E002000740068006500200043006F006E00740072006F006C0020007400610062006C00650000193F0063006F006D006D0061006E0064003D007B0030007D00005349006E00760061006C0069006400200053006F006C00720020005700650062002000550052004900200069006E002000740068006500200043006F006E00740072006F006C0020007400610062006C0065000082E3530045004C00450043005400200054004F00500020007B0030007D00200063006F006E0076006500720073006100740069006F006E005F00680061006E0064006C0065002C00200043004F004E005600450052005400280058004D004C002C0020006D006500730073006100670065005F0062006F0064007900290020006100730020006D006500730073006100670065005F0062006F00640079000D000A0020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000460052004F004D0020005B007B0031007D005D0020005700490054004800200028004E004F004C004F0043004B0029000D000A00200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020005700480045005200450020006D006500730073006100670065005F0074007900700065005F006E0061006D00650020003D00200027007B0032007D0027000D000A00200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020002000200020004F0052004400450052002000420059002000710075006500750069006E0067005F006F0072006400650072002000410053004300012F45004E004400200043004F004E0056004500520053004100540049004F004E00200027007B0030007D0027003B0001355200450043004500490056004500200054004F00500028003000290020002A002000460052004F004D0020007B0030007D003B00000D3C0072006F006F0074003E00000F3C002F0072006F006F0074003E00008598F5897CB4EF4FB0E050B4C83A5F970008B77A5C561934E0890A0007010E0E0E0E0E0E0E070003010E12090E080005010E0E0E0E0E0D0003121415110D0111110E1215070002121512190E0320000102060E06000212190E0E0D00040E0E0E1015110D01111108050001011111040001010E050002080E0E042000111D05200101111D0320000E042001010E0306111D042800111D0328000E040100000005200101112904200101080615110D011111050002020E0E0420001300040001020E0320000204000012410500020E0E0E1507090E121915110D0111110E12151214120912090205200101124504200012550400001159052002010E1C062001125D125D040000126104200012690520020E0E0E0600030E0E1C1C042000126D0320001C0400010A1C032000080E0708124512490E126112690E1C020600020E0E1D1C062002010E12450A07050E124512491D1C02060001021280810A0615128085021280810206000112808D0E08200112809112808D03070102052000128099062001011280990520001280A50500001280A9092002011280991280A90600011280B50E0D2001151280BD0112808112808D09151280850212808102052002011C1819100102151280BD011E00151280BD011E0015128085021E0002050A011280810D1001011D1E00151280BD011E001A070B12809D1280A51280991280AD1280B50E0E121412091214020700011280951219042001010A062001011180C9060702121512150500020E0E1C0A0003020E1180CD1012190C07061245124912190E121902030000010700040E0E1C1C1C0520001280D50420011C080520010113000C07060E124512491280D50E0207070312451249020600030E0E0E0E0620011280E10E0620011280E508060002020E10080B0705081280DD1280E10802040701111D0307010E0801000701000000000801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F77730100000000E8250C5500000000020000001C010000F0500000F032000052534453737035850357854FB279B4419AF1801C01000000633A5C55736572735C566972656B525C446F63756D656E74735C56697375616C2053747564696F20323031335C50726F6A656374735C536F6C725570646174652E434C525C536F6C725570646174652E434C525C6F626A5C44656275675C536F6C725570646174652E434C522E706462000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003452000000000000000000004E52000000200000000000000000000000000000000000000000000040520000000000000000000000005F436F72446C6C4D61696E006D73636F7265652E646C6C0000000000FF25002000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100000001800008000000000000000000000000000000100010000003000008000000000000000000000000000000100000000004800000058600000640200000000000000000000640234000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000000000000000000000000000000003F000000000000000400000002000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B004C4010000010053007400720069006E006700460069006C00650049006E0066006F000000A001000001003000300030003000300034006200300000002C0002000100460069006C0065004400650073006300720069007000740069006F006E000000000020000000300008000100460069006C006500560065007200730069006F006E000000000030002E0030002E0030002E003000000048001300010049006E007400650072006E0061006C004E0061006D006500000053006F006C0072005500700064006100740065002E0043004C0052002E0064006C006C00000000002800020001004C006500670061006C0043006F0070007900720069006700680074000000200000005000130001004F0072006900670069006E0061006C00460069006C0065006E0061006D006500000053006F006C0072005500700064006100740065002E0043004C0052002E0064006C006C0000000000340008000100500072006F006400750063007400560065007200730069006F006E00000030002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000030002E0030002E0030002E0030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005000000C000000603200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
    WITH PERMISSION_SET = UNSAFE;


GO
ALTER ASSEMBLY [SolrUpdate.CLR]
    DROP FILE ALL
    ADD FILE FROM 0x4D6963726F736F667420432F432B2B204D534620372E30300D0A1A445300000000020000020000002B000000CC0000000000000027000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000C0FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF3800000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0BCA3101380000000010000000100000000000001100FFFF04000000038000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000BCA3101380000000010000000100000000000001200FFFF0400000003800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000942E3101E8250C5501000000737035850357854FB279B4419AF1801C000000000000000001000000010000000000000000000000000000004191320100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000BCA310138000000001000000010000000000000FFFFFFFF040000000380000000000000FFFFFFFF00000000FFFFFFFF00000000FFFFFFFF0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000BCA310138000000001000000010000000000000FFFFFFFF040000000380000000000000FFFFFFFF00000000FFFFFFFF00000000FFFFFFFF000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F862513FC607D311905300C04FA302A1C4454B99E9E6D211903F00C04FA302A10B9D865A1166D311BD2A0000F80849BD60A66E40CF64824CB6F042D48172A7991000000000000000C9BA06B46B8EDC2C3346340BBC45D8B00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000200000003000000040000000500000006000000090000000B0000000C0000000D0000000E0000000F00000010000000110000001200000013000000140000001500000007000000080000000A000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000C208000000000000C2080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000FEEFFEEF01000000D600000000633A5C55736572735C566972656B525C446F63756D656E74735C56697375616C2053747564696F20323031335C50726F6A656374735C536F6C725570646174652E434C525C536F6C725570646174652E434C525C53656E64536F6C72576562526571756573742E63730000633A5C75736572735C766972656B725C646F63756D656E74735C76697375616C2073747564696F20323031335C70726F6A656374735C736F6C727570646174652E636C725C736F6C727570646174652E636C725C73656E64736F6C72776562726571756573742E637300040000006B00000000000000010000006C00000003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001BE2300180000000CF72E1FB1463D00101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000020000000100000001000000000000006C000000280000001BE23001526A92B758000000010000006B0000006C000000650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000003E002A11000000009001000000000000A80000000000000000000000080000062507000001000000004765744D65737361676546726F6D51756575650000000016000311040000005C010000A800000025070000010000001E002011040000000800001100000000000004004353243124303030300000001E002011050000000800001100000000000004004353243424303030310000001E002011000000000800001100000000000000006D657373616765426F647900160003114400000058010000920000003307000001000000220020110100000008000011000000000000000073716C436F6E6E656374696F6E00000016000311BC00000054010000720000003E070000010000001E0020110200000008000011000000000000000073716C436F6D6D616E640000220020110300000008000011000000000000000073716C446174615265616465720000000200060002000600020006002E000404C93FEAC6B359D649BC250902BBABB460000000004D0044003200000004010000040100000C00000001000006020006003A002A1100000000B0020000000000004E000000000000000000000009000006CD0700000100000000456E64436F6E766572736174696F6E0000000016000311940100007C0200004E000000CD070000010000001E0020110200000009000011000000000000040043532434243030303000000016000311D0010000780200004C000000CE07000001000000220020110000000009000011000000000000000073716C436F6E6E656374696F6E0000001600031108020000740200002E000000D9070000010000001600201101000000090000110000000000000000636D64000200060002000600020006002E000404C93FEAC6B359D649BC250902BBABB460000000004D0044003200000004010000040100000C00000001000006020006003E002A1100000000D4030000000000004200000000000000000000000A0000061B08000001000000005265736574517565756541637469766174696F6E00000016000311B4020000A0030000420000001B080000010000001E0020110200000009000011000000000000040043532434243030303000000016000311F40200009C030000400000001C08000001000000220020110000000009000011000000000000000073716C436F6E6E656374696F6E000000160003112C030000980300002200000027080000010000001600201101000000090000110000000000000000636D64000200060002000600020006002E000404C93FEAC6B359D649BC250902BBABB460000000004D0044003200000004010000040100000C000000010000060200060046002A110000000030050000000000006500000000000000000000000B0000065D08000001000000004765744B657942795461674E616D6546726F6D586D6C4D657373616765000016000311D8030000FC040000650000005D080000010000001E002011030000000A00001100000000000004004353243124303030300000001E002011040000000A00001100000000000004004353243424303030310000001600031120040000F80400005B0000005E080000010000002E002011000000000A000011000000000000000073746167655472616E736974696F6E436F6D706F736974654B65790016002011010000000A0000110000000000000000646F63001E002011020000000A00001100000000000000006E6F64654C6973740000000002000600020006002E000404C93FEAC6B359D649BC250902BBABB460000000004D0044003200000004010000040186030C0000000100000602000600F2000000140100002507000001000100A800000000000000150000000801000000000000F100008001000000F200008008000000F30000800E000000F500008019000000F60000801A000000F700008021000000F90000833A000000FE0000804200000000010080490000000201008054000000EEEFFE80580000000301008059000000040100807500000005010080820000000601008083000000070100808A000000080100808B000000EEEFFE809F000000EEEFFE80A000000009010080A50000000A01008009000A000D0027000D002F0014005E000D000E001100260011009C0011002F0011004A0011002A0000000000110012001500500015003F0011001200110027000D000E0000000000000000000D00200009000A00F200000090000000CD070000010001004E000000000000000A00000084000000000000000D010080010000000E0100800C0000000F0100800D000000100100801400000011010080320000001201008039000000130100803A000000EEEFFE804C000000EEEFFE804D0000001401008009000A0014005E000D000E001100260011008A00110027000D000E00000000000000000009000A00F2000000900000001B0800000100010042000000000000000A00000084000000000000001701008001000000180100800C000000190100800D0000001A010080140000001B010080260000001C0100802D0000001D0100802E000000EEEFFE8040000000EEEFFE80410000001E01008009000A0014005E000D000E001100260011007900110027000D000E00000000000000000009000A00F2000000E40000005D08000001000100650000000000000011000000D800000000000000210100800100000023010080020000002401008004000000250100800A000000260100802100000028010080290000002901008037000000EEEFFE803B0000002A0100803C0000002B010080570000002C010080580000002E0100805C000000300100805D000000310100805E0000003201008062000000EEEFFE80630000003401008009000A000D000E0011003500110035001100410011004D0011002800000000001100120015006A0011001200110034000D0012000D000E0011001A000000000009000A00F40000000800000001000000000000002000000000000000240000003C0000005C0000007400000098000000B0000000DC00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000003A002A11000000008401000000000000DB0000000000000000000000070000063F0600000100000000476574536F6C72446174615765625552490000160003110400000050010000DB0000003F060000010000001E002011040000000700001100000000000004004353243124303030300000001E002011050000000700001100000000000004004353243424303030310000001600201102000000070000110000000000000000757269002600201103000000070000110000000000000000736F6C61725765625572694C6F63616C0000000016000311400000004C010000450000005406000001000000220020110000000007000011000000000000000073716C436F6E6E656374696F6E00000016000311D800000048010000250000005F060000010000001A00201101000000070000110000000000000000636F6D6D616E64000200060002000600020006002E000404C93FEAC6B359D649BC250902BBABB460000000004D0044003200000004010000040100110C00000001000006020006002E002A1100000000E8010000000000000B0000000000000000000000150000061A07000001000000002E6363746F72002E000404C93FEAC6B359D649BC250902BBABB460000000004D00440032000000040100000401D7000C0000000100000602000600F2000000680100003F06000001000100DB000000000000001C0000005C01000000000000D100008001000000D200008010000000EEEFFE8014000000D300008015000000D500008020000000D600008021000000D700008028000000D800008034000000D900008044000000DA00008045000000EEEFFE8059000000EEEFFE805A000000DC00008069000000EEEFFE806D000000DD00008078000000DE00008079000000DF0000807B000000E000008081000000E100008091000000EEEFFE8095000000E200008096000000E3000080A7000000E4000080A8000000E6000080C4000000EEEFFE80C8000000E7000080D3000000E9000080D8000000EA00008009000A000D003700000000000D000E00180062001100120015002A001500A90015004200110012000000000000000000110036000000000015005A000D000E000D001C000D0032000D002800000000000D000E0011004D000D000E000D00920000000000110052000D00180009000A00F2000000300000001A070000010001000B00000000000000020000002400000000000000CF0000800A000000EEEFFE800900310000000000F400000008000000010000000000000010000000F4000000140100002C01000044010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000003A002A11000000005C030000000000006401000000000000000000000100000600000000010000000053656E64536F6C7257656252657175657374001600031104000000280300006401000000000000010000001E002411554D6963726F736F66742E53716C5365727665722E536572766572000A0024115553797374656D001A0024115553797374656D2E446174612E53716C436C69656E7400000E0024115553797374656D2E494F00000E0024115553797374656D2E4E657400160024115553797374656D2E5265666C656374696F6E0000120024115553797374656D2E54657874000000000E0024115553797374656D2E586D6C00160024115553797374656D2E586D6C2E4C696E7100000000120024115553797374656D2E4C696E7100000000160024115553797374656D2E446961676E6F7374696373001E002011080000000100001100000000000004004353243424303030300000001E002011000000000100001100000000000000006D657373616765426F6479001600031140000000BC0200001E01000007000000010000001600201101000000010000110000000000000000757269002600201102000000010000110000000000000000636F6E766572736174696F6E48616E646C650000160003118001000050020000860000001E00000001000000220020110300000001000011000000000000000072657175657374436F6E74656E7473001A0020110400000001000011000000000000000072657175657374001E00201105000000010000110000000000000000726573706F6E736500000000020006001600031180010000B80200004A000000A8000000010000001600201106000000010000110000000000000000657800001600031154020000B402000010000000DE0000000100000016002011070000000100001100000000000000006578320002000600020006000200060016000311400000002403000037000000290100000100000016002011060000000100001100000000000000006578000016000311C0020000200300001E0000003E010000010000001600201107000000010000110000000000000000657832000200060002000600020006002E000404C93FEAC6B359D649BC250902BBABB460000000004D0044003200000004010000040000000C00000001000B000200060032002A11000000001C050000000000006A0200000000000000000000020000066401000001000000004C6F674572726F720000001600031160030000E80400006A02000064010000010000001E002011070000000200001100000000000004004353243424303030300000001600031194030000E4040000680200006501000001000000220020110000000002000011000000000000000073716C436F6E6E656374696F6E00000016000311CC030000E00400004802000070010000010000001600201101000000020000110000000000000000636D64001600031108040000DC0400002D02000076010000010000001A0020110200000002000011000000000000000071756572790000001A002011030000000200001100000000000000006D6574686F6400001A0020110400000002000011000000000000000074797065000000001E0020110500000002000011000000000000000066756C6C4E616D6500000000160020110600000002000011000000000000000069640000020006000200060002000600020006002E000404C93FEAC6B359D649BC250902BBABB460000000004D0044003200000004010000040100000C00000001000006020006003A002A11000000007C06000000000000A5000000000000000000000003000006CE030000010000000053656E64546F4572726F725175657565000000160003112005000048060000A5000000CE030000010000001E002011030000000300001100000000000004004353243024303030300000001E002011040000000300001100000000000004004353243424303030310000001E00201100000000030000110000000000000000717565727954657874000000160003115C050000440600007F000000F303000001000000220020110100000003000011000000000000000073716C436F6E6E656374696F6E00000016000311D4050000400600005F000000FE030000010000001600201102000000030000110000000000000000636D64000200060002000600020006002E000404C93FEAC6B359D649BC250902BBABB460000000004D0044003200000004010000040100000C000000010000060200060046002A11000000003407000000000000240000000000000000000000130000067304000001000000003C476574526573706F6E7365487474705374617475733E625F5F31000000001600031180060000000700002400000073040000010000001E00201100000000040000110000000000000400435324312430303030000000020006002E000404C93FEAC6B359D649BC250902BBABB460000000004D0044003200000004010000040118010C000000010000060200060046002A1100000000EC07000000000000240000000000000000000000140000069704000001000000003C476574526573706F6E7365487474705374617475733E625F5F32000000001600031138070000B80700002400000097040000010000001E00201100000000040000110000000000000400435324312430303030000000020006002E000404C93FEAC6B359D649BC250902BBABB460000000004D0044003200000004010000040118010C00000001000006020006003E002A1100000000480A00000000000037010000000000000000000004000006BB0400000100000000476574526573706F6E736548747470537461747573000016000311F0070000140A000037010000BB040000010000001E002011090000000500001100000000000004004353243124303030300000001E0020110A0000000500001100000000000004004353243424303030310000001600031130080000100A000032010000BC04000001000000220020110000000005000011000000000000000073747265616D5772697465720000000016000311880800000C0A000014010000C8040000010000001E00201101000000050000110000000000000000726573706F6E73650000000016000311C4080000D4090000F8000000CB0400000100000022002011020000000500001100000000000000007265636569766553747265616D0000001E002011030000000500001100000000000000007265616453747265616D00001600201104000000050000110000000000000000786D6C001A0020110500000005000011000000000000000073746174757300002200201106000000050000110000000000000000696D706F7274526573706F6E7365000022002011070000000500001100000000000000003C3E675F5F696E69744C6F63616C30000200060016000311C4080000080A000003000000C505000001000000160020110800000005000011000000000000000065780000020006000200060002000600020006002E000404C93FEAC6B359D649BC250902BBABB460000000004D0044003200000004010000040100000C00000001000006020006003E002A1100000000140B0000000000004D000000000000000000000005000006F20500000100000000437265617465536F6C7257656252657175657374000000160003114C0A0000E00A00004D000000F2050000010000001E002011010000000600001100000000000004004353243124303030300000001A002011000000000600001100000000000000007265717565737400020006002E000404C93FEAC6B359D649BC250902BBABB460000000004D0044003200000004010000040118010C0000000100000602000600F20000004803000000000000010001006401000000000000440000003C0300000000000012000080010000001400008007000000160000800800000017000080100000001900008018000000EEEFFE801D0000001C0000801E0000001E0000801F0000001F00008025000000220000802E0000002500008039000000EEEFFE803B000000270000803C0000002800008052000000EEEFFE805600000029000080570000002A000080590000002C000080650000002D0000806E0000002E000080790000002F0000807A000000260000807D000000EEEFFE807F0000003200008092000000EEEFFE809600000033000080A300000034000080A4000000EEEFFE80A600000035000080A800000036000080A900000038000080AA00000039000080B80000003A000080C60000003C000080D30000003E000080D90000003F000080DA000000EEEFFE80DC00000040000080DE00000041000080DF00000042000080ED00000043000080EE000000EEEFFE80F0000000EEEFFE80F100000044000080F2000000EEEFFE80F4000000EEEFFE80F500000045000080F60000001B00008016010000EEEFFE801D01000046000080240100004700008025010000EEEFFE80270100004800008029010000490000802A0100004B0000802B0100004C000080390100004D0000803A010000EEEFFE803C0100004E0000803E0100004F0000803F010000500000805B010000510000805C010000EEEFFE805E010000EEEFFE805F0100005200008060010000EEEFFE8062010000EEEFFE8063010000530000800500060009002B0009000A000D004A000D002D00000000000D000E0011001200150038001500590015006800000000001500160019003D000000000019001A001D0023001900500019004E001900680015001600150021000000000015004600000000001900600011001200000000001100250011001200150016001900490019006E001900600019003400150016000000000015002A001500160019004A001500160000000000000000001100120000000000000000000D000E000D00BB00000000000D00500009000A000000000009001D0009000A000D000E00110041000D000E00000000000D0022000D000E00110054000D000E00000000000000000009000A00000000000000000005000600F2000000EC01000064010000010001006A0200000000000027000000E0010000000000005600008001000000570000800C000000580000801200000059000080130000005A0000801A0000005B000080220000005D0000822800000060000080300000006100008050000000620000806B0000006300008082000000640000809E00000065000080A400000066000080AC00000067000080CF00000068000080E700000069000080020100006B0000801D0100006C0000804E0100006D000080560100006F0000815C01000071000080640100007200008070010000730000809201000074000080AE01000075000080C901000076000080D001000078000080DC01000079000080FE0100007A000080150200007B000080300200007C000080370200007D0000803E0200007E0000803F020000EEEFFE8053020000EEEFFE8054020000EEEFFE8068020000EEEFFE80690200007F0000800500060010005A001000310009000A000D0022000D002C000D003B000D0025000D004F000D004D000D004C000D0049000D0038000D002D000D00A4000D0046000D0048000D004D000D00A0000D002A000D005F000D0025000D0024000D0058000D0053000D004F000D0023000D0024000D0058000D0051000D004D000D0023000D00230009000A000000000000000000000000000000000005000600F2000000E4000000CE03000001000100A50000000000000011000000D800000000000000820000800100000083000088250000008C000080300000008D000080380000008E000080390000008F0000804000000090000080480000009100008054000000920000806B00000093000080720000009400008079000000950000807A000000EEEFFE808E000000EEEFFE808F000000EEEFFE80A3000000EEEFFE80A400000096000080050006000900730010005A001000490009000A000D0022000D0029000D0024000D004E000D0023000D00230009000A000000000000000000000000000000000005000600F20000003000000073040000010001002400000000000000020000002400000000000000AA00008022000000EEEFFE804000650000000000F20000003000000097040000010001002400000000000000020000002400000000000000AB00008022000000EEEFFE804800750000000000F200000050010000BB0400000100010037010000000000001A000000440100000000000099000080010000009A0000800D0000009B0000800E0000009C000080100000009E000080110000009F00008019000000A000008020000000A100008027000000A40000802E000000A600008035000000A700008041000000A90000804E000000AA00008091000000AB000080D4000000AD00008508010000B40000800A010000B50000800B010000B60000800D010000B90000800E010000BA00008014010000EEEFFE8018010000BB0000801F010000BC00008020010000EEEFFE8033010000EEEFFE8034010000BE000080050006001000580009000A000D0029000D000E00110035001100260011002600110032001100450011005A001100430011007A0011008A00110013000D0021000D000E00110017000D000E001100260000000000150026000D000E00000000000000000005000600F200000084000000F2050000010001004D00000000000000090000007800000000000000C100008001000000C20000800D000000C300008019000000C400008025000000C500008033000000C60000803B000000C700008047000000C80000804B000000C900008005000600090049000900210009003200090038000900660009002E000900180005000600F4000000080000000100000000000000380000005C0100008001000098010000B0010000C8010000E8010000000200002C020000440200007002000088020000AC020000C4020000E8020000000000000000000000000000000000000000000000000000FFFFFFFF1A092FF1D00000006C020000B101000001000000DD000000010000003D00000001000000E9010000010000002D020000010000007500000001000000C502000001000000810100000100000099000000010000001501000001000000AD0200000100000001000000010000007102000001000000E9020000010000004501000001000000C9010000010000002D010000010000002500000001000000450200000100000001020000010000005D00000001000000F5000000010000005D01000001000000B10000000100000099010000010000008902000001000000010400000000000000000000200000000000000000000000000000000000000001000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000001010400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010004000200000000000000000000000000000000000000000000000000000001000000020000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000002000000000000000000000000000000900000000000000000000000000000000200400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000080000000080000000000000000000000000000000000000000000000000000000000400000000000000000C0000001800000024000000300000003C0000004800000054000000600000006C0000007800000084000000900000009C000000A8000000B4000000C0000000CC000000D8000000E4000000F0000000FC0000000801000014010000200100002C01000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000022002511000000000400000003004765744D65737361676546726F6D51756575650000001600291100000000040000000300303630303030303800001E00251100000000940100000300456E64436F6E766572736174696F6E0000001600291100000000940100000300303630303030303900002200251100000000B402000003005265736574517565756541637469766174696F6E00001600291100000000B40200000300303630303030306100002A00251100000000D803000003004765744B657942795461674E616D6546726F6D586D6C4D657373616765001600291100000000D80300000300303630303030306200001E00251100000000040000000200476574536F6C72446174615765625552490016002911000000000400000002003036303030303037000016002511000000008801000002002E6363746F7200000000160029110000000088010000020030363030303031350000220025110000000004000000010053656E64536F6C72576562526571756573740000000016002911000000000400000001003036303030303031000016002511000000006003000001004C6F674572726F7200001600291100000000600300000100303630303030303200001E0025110000000020050000010053656E64546F4572726F725175657565000016002911000000002005000001003036303030303033000010000000000000000000000000000000000000000000000000000000FFFFFFFF1A092FF100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002A002511000000008006000001003C476574526573706F6E7365487474705374617475733E625F5F310000001600291100000000800600000100303630303030313300002A002511000000003807000001003C476574526573706F6E7365487474705374617475733E625F5F320000001600291100000000380700000100303630303030313400002200251100000000F00700000100476574526573706F6E736548747470537461747573001600291100000000F007000001003036303030303034000022002511000000004C0A00000100437265617465536F6C7257656252657175657374000016002911000000004C0A000001003036303030303035000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000FFFFFFFF77093101010000000E00008B0F0015C61000094638010000700100002C00000088000000000000000000000016000000190000000000EEC00000000000000000FFFF000000000000FFFFFFFF00000000FFFF0000000000000000000000000D00180B0000000000009408000001000000B8CB6001000000000000000053746F72656450726F6365647572657300434441353133364600000000000000FFFF000000000000FFFFFFFF00000000FFFF0000000000000000000000000C00EC01000000000000B801000001000000A8CC6001000000000000000053746F72656450726F636564757265732E55726948656C7065720039343837313536440000000000FFFF000000000000FFFFFFFF00000000FFFF0000000000000000000000000B003405000000000000480300000100000008CC6001000000000000000053746F72656450726F636564757265732E5365727669636542726F6B65724D6573736167696E6748656C70657200413344463546353000002DBA2EF10100580100000000640100000000000000000000000000000000000001000000640100006A0200000000000000000000000000000000000001000000CE030000A500000000000000000000E50000000000000000010067017304000024000000000000000000000000000000000000000100000097040000240000000000000000000000000000000000000001000000BB040000370100000000000000000000000000000000000001000000F20500004D00000000000000000000000000000000000000010000003F060000DB00000000000000010000000000000000000000010000001A0700000B000000000000000100000000000000000000000100000025070000A80000000000000002000000000000000000000001000000CD0700004E00000000000000020000000000000000000000010000001B0800004200000000000000020000000000000000000000010000005D0800006500000000000000020000000000000000000000020002000D01000000000100FFFFFFFF00000000C20800000802000000000000FFFFFFFF00000000FFFFFFFF03000300000001000200010001000100000000000000000000000000633A5C55736572735C566972656B525C446F63756D656E74735C56697375616C2053747564696F20323031335C50726F6A656374735C536F6C725570646174652E434C525C536F6C725570646174652E434C525C53656E64536F6C72576562526571756573742E6373000000FEEFFEEF010000000100000000010000000000000000000000FFFFFFFFFFFFFFFFFFFF0A000900FFFFFFFFFFFFFFFF0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000942E3101E8250C5501000000737035850357854FB279B4419AF1801C970000002F4C696E6B496E666F002F6E616D6573002F7372632F686561646572626C6F636B002F7372632F66696C65732F633A5C75736572735C766972656B725C646F63756D656E74735C76697375616C2073747564696F20323031335C70726F6A656374735C736F6C727570646174652E636C725C736F6C727570646174652E636C725C73656E64736F6C72776562726571756573742E6373000400000006000000010000003A0000000000000011000000070000000A0000000600000000000000050000002200000008000000000000004191320100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001100000020000000F300000038000000CB0300003800000000000000FA00000080000000580000005800000028000000A0080000B8030000E81300004C0300002C000000000300000300000025000000060000002300000024000000070000000B0000000C00000008000000090000000A0000000D0000000E0000000F000000100000001100000012000000130000001400000015000000160000001700000018000000190000001A0000001B0000001C0000001D0000001E0000001F00000021000000200000002200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 AS N'SolrUpdate.CLR.pdb';




PRINT N'Creating SolrUpdate.CLR...';
GO

SET QUOTED_IDENTIFIER ON
GO

/******************* CREATE CLR PROC ************************/

CREATE PROCEDURE solr.SendSolrWebRequest
											@indexName			NVARCHAR (4000), 
											@importType			NVARCHAR (4000), 
											@TargetQueue		NVARCHAR (4000), 
											@InitiatorMessage	NVARCHAR (4000),
											@InitiatorService	NVARCHAR (4000),
											@ErrorQueueTarget	NVARCHAR (4000),
											@Contract			NVARCHAR (4000)
AS 

/*****************************************************************************************************************************************
		Author		:	VirekR
		CreateDate	:	2015/02/06
		Description	:	This proc will pass through an Index Name (ThirdParty,ThirdParty etc) and an import type (full or delta import etc)
						to the CLR proc which will pick up the required URI
						(SELECT * from [2am].dbo.[Control] where ControlDescription = 'SolrWebURI') and re-import data where necessary.
																				
		History:							
*****************************************************************************************************************************************/


EXTERNAL NAME [SolrUpdate.CLR].[StoredProcedures].[SendSolrWebRequest]
GO

PRINT N'Creating solr.SendSolrWebRequest...';
GO

/****************** PROC CREATION ****************************/
IF OBJECT_ID('solr.pThirdPartyTargetQueueActivation') is null
BEGIN 
	DECLARE @Qry VARCHAR(1024)
	SET @Qry =	'CREATE PROCEDURE solr.pThirdPartyTargetQueueActivation ' +
				'AS ' +
				'BEGIN ' +
				'SET NOCOUNT ON; ' +
				'END '

	EXECUTE (@Qry)
END
GO
SET QUOTED_IDENTIFIER ON
GO


/****************** Create processing procedure for target queue ****************************/
ALTER PROCEDURE solr.pThirdPartyTargetQueueActivation
AS

/*****************************************************************************************************************************************
		Author		:	VirekR
		CreateDate	:	2015/02/06
		Description	:	This proc will get the required GenericKey that will be passed as a message
						and make a call to the ThirdParty proc to re-run the ThirdParty dataset and reprocess the Solr index
																				
		History:							
*****************************************************************************************************************************************/

BEGIN
  SET NOCOUNT ON;
 	  
    DECLARE	@LegalEntityKey INT,
			@Count			INT = 1,
			@Msg			VARCHAR(1024) = ''

   IF OBJECT_ID('tempdb.dbo.#LEIterator') IS NOT NULL
		DROP TABLE #LEIterator 	

   CREATE TABLE #LEIterator (ID INT IDENTITY(1,1),MessageBody XML, GenericKey INT)

   INSERT INTO #LEIterator (MessageBody,GenericKey )
   SELECT	CAST(message_body AS XML),
			CAST(message_body AS XML).value('(/row/GenericKey)[1]', 'int' )
   FROM		ThirdPartyTargetQueue    
         
   WHILE @Count <= (SELECT COUNT(*) FROM #LEIterator)
   BEGIN
		SELECT	@LegalEntityKey = GenericKey 
		FROM	#LEIterator
		WHERE	ID = @Count	

		/*Optional Parameter of LegalEntityKey, if populated do that one only, if not do all */  
		EXEC Process.solr.pThirdPartyExtract @Msg OUTPUT, @LegalEntityKey
	
		SELECT @Count = @Count + 1	

   END -- END WHILE
  
  EXEC [2am].solr.SendSolrWebRequest	'ThirdParty',					--	IndexName
										'delta-import&clean=false',		--	Import Type (full-import or delta-import)
										'ThirdPartyTargetQueue',		--	TargetQueue 
										'ThirdPartyInitiatorMessage',	--	InitiatorMessage
										'ThirdPartyInitiatorService',	--	InitiatorService
										'ThirdPartyErrorQueueTarget',	--	ErrorQueueTarget
										'ThirdPartyContract'			--	Contract
      
END
GO


IF OBJECT_ID('solr.pThirdPartyInitiatorQueueActivation') is null
BEGIN 
	DECLARE @Qry VARCHAR(1024)
	SET @Qry =	'CREATE PROCEDURE solr.pThirdPartyInitiatorQueueActivation ' +
				'AS ' +
				'BEGIN ' +
				'SET NOCOUNT ON; ' +
				'END '

	EXECUTE (@Qry)
END
GO

SET QUOTED_IDENTIFIER ON
GO

/********************* Create procedure for processing replies to the initiator queue **************************/
ALTER PROCEDURE solr.pThirdPartyInitiatorQueueActivation
AS

/*****************************************************************************************************************************************
		Author		:	VirekR
		CreateDate	:	2015/02/06
		Description	:	This proc will receive the reply message and end the conversation
																				
		History:							
*****************************************************************************************************************************************/
BEGIN
  SET NOCOUNT ON;
 
  DECLARE @conversation_handle UNIQUEIDENTIFIER;
  DECLARE @message_body XML;
  DECLARE @message_type_name sysname;
 
  WHILE (1=1)
  BEGIN
    BEGIN TRANSACTION;
 
    WAITFOR
    (
      RECEIVE TOP (1)
        @conversation_handle = conversation_handle,
        @message_body = CAST(message_body AS XML),
        @message_type_name = message_type_name
      FROM ThirdPartyInitiatorQueue
    ), TIMEOUT 5000;
 		
    IF (@@ROWCOUNT = 0)
    BEGIN
      ROLLBACK TRANSACTION;
      BREAK;
    END
 
    IF @message_type_name = N'ThirdPartyTargetMessage'
    BEGIN
      -- If necessary handle the reply message here       
      -- Since this is all the work being done, end the conversation to send the EndDialog message
      END CONVERSATION @conversation_handle;
    END
 
    -- If end dialog message, end the dialog
    ELSE IF @message_type_name = N'http://schemas.microsoft.com/SQL/ServiceBroker/EndDialog'
    BEGIN	
		END CONVERSATION @conversation_handle;
    END
 
    -- If error message, log and end conversation
    ELSE IF @message_type_name = N'http://schemas.microsoft.com/SQL/ServiceBroker/Error'
    BEGIN		
       END CONVERSATION @conversation_handle;
    END
 
    COMMIT TRANSACTION;
  END
END
GO
-- Alter the processing queue to specify internal activation
ALTER QUEUE ThirdPartyTargetQueue
    WITH ACTIVATION
    ( 
      STATUS = ON,
      PROCEDURE_NAME = solr.pThirdPartyTargetQueueActivation,	  
      MAX_QUEUE_READERS = 10,
      EXECUTE AS OWNER
    );
GO
 
-- Alter the request queue to specify internal activation
ALTER QUEUE ThirdPartyInitiatorQueue
    WITH ACTIVATION
    ( 
      STATUS = ON,
      PROCEDURE_NAME = solr.pThirdPartyInitiatorQueueActivation,
      MAX_QUEUE_READERS = 10,
      EXECUTE AS OWNER
    );
GO


/*********************** IF THERE IS AN ERROR GET THIS HANDLED IN ITS OWN ERROR QUEUE ***********************/

CREATE PROCEDURE solr.pThirdPartyErrorQueueActivation
AS

/*****************************************************************************************************************************************
		Author		:	VirekR
		CreateDate	:	2015/02/06
		Description	:	This proc will send any error messages back into the queue for processing
																				
		History:							
*****************************************************************************************************************************************/

	DECLARE @Dialog_Handle UNIQUEIDENTIFIER;
	DECLARE @messageType SYSNAME;
	DECLARE @MessageBody XML;
BEGIN
	
	ALTER QUEUE ThirdPartyTargetQueue WITH ACTIVATION ( STATUS = OFF )
	BEGIN TRANSACTION;
		WAITFOR (RECEIVE TOP (1) @Dialog_Handle = conversation_handle,
		@messageType = message_type_name,
		@MessageBody = message_body
		FROM ThirdPartyErrorQueue), TIMEOUT 1000;

		WHILE (@Dialog_Handle IS NOT NULL)
		BEGIN
		BEGIN TRY

			--Send message back to the main queue to be processed
			DECLARE @handle uniqueidentifier;
		
			IF (@@ROWCOUNT > 0)
			BEGIN
				IF (@messageType <> 'http://schemas.microsoft.com/SQL/ServiceBroker/EndDialog')
				BEGIN
					BEGIN DIALOG CONVERSATION @handle
					FROM SERVICE ThirdPartyErrorQueueInitiator
					TO SERVICE 'ThirdPartyServiceTarget'
					ON CONTRACT ThirdPartyContract
					WITH ENCRYPTION = OFF
					
					;SEND ON CONVERSATION @handle
					MESSAGE TYPE ThirdPartyTargetMessage (@MessageBody);
					END CONVERSATION @handle
				END
			END
				
			END CONVERSATION @Dialog_Handle

			COMMIT

		END TRY
		BEGIN CATCH
			-- If there are any exceptions then
			-- rollback the transaction and stop processing the queue
			ROLLBACK TRANSACTION;
			ALTER QUEUE ThirdPartyErrorQueue WITH ACTIVATION ( STATUS = OFF );
			BEGIN TRANSACTION
				BREAK
		END CATCH 
		-- Try to loop once more if there are more messages
		SELECT @Dialog_Handle = NULL;
		BEGIN TRANSACTION;
			WAITFOR (RECEIVE TOP (1) @Dialog_Handle = conversation_handle,
			@messageType = message_type_name,
			@MessageBody = message_body
			FROM ThirdPartyErrorQueue), TIMEOUT 1000;
	END
		COMMIT;
	--Shutdown processing of the error queue when we have gone through
	--all existing messages in the queue
	ALTER QUEUE ThirdPartyErrorQueue  WITH ACTIVATION ( STATUS = OFF );
	ALTER QUEUE ThirdPartyTargetQueue WITH ACTIVATION ( STATUS = ON )

END

GO

/******** CREATE AN ERROR QUEUE WHICH CONTAINS A LIST OF MESSAGES THAT WAS NOT RECEIVED CORRECTLY  ************/

CREATE QUEUE ThirdPartyErrorQueue WITH STATUS = ON , RETENTION = OFF ,
	ACTIVATION ( STATUS = OFF , PROCEDURE_NAME = solr.pThirdPartyErrorQueueActivation ,MAX_QUEUE_READERS = 1 , EXECUTE AS OWNER) ON [PRIMARY]
GO

CREATE SERVICE ThirdPartyErrorQueueInitiator
ON QUEUE ThirdPartyErrorQueue
(
	ThirdPartyContract
)

GO
CREATE SERVICE ThirdPartyErrorQueueTarget
ON QUEUE ThirdPartyErrorQueue
(
	ThirdPartyContract
)

GO
PRINT '3730_ServiceBrokerSetup deployed: ' + cast(getdate() as varchar) + ' to server: '+ @@Servername
GO

